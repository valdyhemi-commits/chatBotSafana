<!DOCTYPE html>
<html lang="id" class="dark">
<head>
    <meta charset="UTF-8">
    <title>Chatbot Sederhana dengan Groq</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        primary: '#4f46e5',
                        secondary: '#9333ea'
                    }
                }
            }
        }
    </script>
</head>
<body class="min-h-screen flex justify-center items-center p-2 sm:p-4 bg-gradient-to-br from-indigo-200 via-purple-200 to-pink-200 dark:from-gray-900 dark:via-gray-800 dark:to-gray-900 transition-colors duration-500">

    <div class="w-full max-w-full sm:max-w-lg bg-white dark:bg-gray-800 rounded-2xl shadow-2xl overflow-hidden transform hover:scale-[1.01] transition-all duration-300">
        <!-- Header dengan tombol mode -->
        <div class="flex justify-between items-center px-4 sm:px-6 py-3 sm:py-4 bg-gradient-to-r from-primary to-secondary text-white">
            <h1 class="text-lg sm:text-xl font-bold">ðŸ’¬ ChatBot Kelompok 3</h1>
            <button id="theme-toggle" class="px-2 sm:px-3 py-1 bg-white/20 rounded-lg text-xs sm:text-sm backdrop-blur-md hover:bg-white/30 transition">
                ðŸŒ™
            </button>
        </div>

        <!-- Chat box -->
        <div id="chat-box" class="h-[60vh] sm:h-[500px] p-3 sm:p-4 overflow-y-auto space-y-3 bg-gray-50 dark:bg-gray-900">
            <!-- Pesan akan muncul di sini -->
        </div>

        <!-- Input -->
        <div class="flex flex-col sm:flex-row items-stretch sm:items-center gap-2 sm:gap-3 p-3 sm:p-4 bg-gray-100 dark:bg-gray-800 border-t border-gray-200 dark:border-gray-700">
            <input id="user-input" type="text" placeholder="Ketik pesan Anda..."
                class="flex-1 px-3 sm:px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-primary text-sm sm:text-base" />
            <button id="send-btn" class="px-4 sm:px-5 py-2 bg-gradient-to-r from-primary to-secondary text-white rounded-lg shadow-lg transform hover:scale-105 transition text-sm sm:text-base">
                Kirim
            </button>
        </div>
    </div>

    <script>
        // Theme Toggle
        const themeToggle = document.getElementById('theme-toggle');
        themeToggle.addEventListener('click', () => {
            document.documentElement.classList.toggle('dark');
            themeToggle.textContent = document.documentElement.classList.contains('dark') ? 'ðŸŒž' : 'ðŸŒ™';
        });

        const chatBox = document.getElementById('chat-box');
        const userInput = document.getElementById('user-input');
        const sendBtn = document.getElementById('send-btn');

        sendBtn.addEventListener('click', sendMessage);
        userInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') sendMessage();
        });

        function sendMessage() {
            const message = userInput.value.trim();
            if (!message) return;

            appendMessage('user', message);
            userInput.value = '';

            fetch('/chat', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ message: message })
            })
            .then(response => response.json())
            .then(data => {
                if (data.error) {
                    appendMessage('bot', 'Error: ' + data.error);
                } else {
                    appendMessage('bot', data.response);
                }
            })
            .catch(error => {
                appendMessage('bot', 'Error: ' + error);
            });
        }

        function appendMessage(sender, text) {
            const div = document.createElement('div');
            div.className = sender === 'user'
                ? 'self-end max-w-[85%] p-2 sm:p-3 rounded-lg bg-gradient-to-r from-green-400 to-emerald-500 text-white shadow-lg text-sm sm:text-base'
                : 'self-start max-w-[85%] p-2 sm:p-3 rounded-lg bg-gradient-to-r from-gray-200 to-gray-300 dark:from-gray-700 dark:to-gray-600 text-gray-900 dark:text-gray-100 shadow-lg text-sm sm:text-base';
            div.textContent = text;

            const wrapper = document.createElement('div');
            wrapper.className = 'flex ' + (sender === 'user' ? 'justify-end' : 'justify-start');
            wrapper.appendChild(div);

            chatBox.appendChild(wrapper);
            chatBox.scrollTop = chatBox.scrollHeight;
        }
    </script>
</body>
</html>
